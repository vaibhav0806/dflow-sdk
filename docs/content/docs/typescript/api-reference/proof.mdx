---
title: Proof API
description: KYC verification for DFlow prediction markets
---

import { Callout } from 'fumadocs-ui/components/callout';

# Proof API

The Proof API provides KYC (Know Your Customer) verification functionality for DFlow prediction markets. Use this API to check if a wallet address has completed verification, generate signature messages for wallet ownership proof, and build deep links for partner integration.

<Callout type="info">
  Proof is DFlow's KYC verification service. Users must complete verification before trading on certain markets.
</Callout>

## Access

```typescript
import { DFlowClient } from 'dflow-sdk';

const dflow = new DFlowClient();
const proof = dflow.proof;
```

## Methods

### verifyAddress

Check if a wallet address has completed KYC verification.

```typescript
const result = await dflow.proof.verifyAddress(
  '7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU'
);

if (result.verified) {
  console.log('User is verified!');
} else {
  console.log('User needs to complete KYC');
}
```

**Parameters:**

| Name | Type | Required | Description |
|------|------|----------|-------------|
| `address` | `string` | Yes | Solana wallet address to check |

**Returns:** `Promise<VerifyAddressResponse>`

```typescript
interface VerifyAddressResponse {
  verified: boolean; // Whether the address has been verified
}
```

---

### generateSignatureMessage

Generate the message to be signed for KYC verification.

The user should sign this message with their wallet to prove ownership. The signature is then used in the deep link for verification.

```typescript
const timestamp = Date.now();
const message = dflow.proof.generateSignatureMessage(timestamp);
console.log(message); // "Proof KYC verification: 1699123456789"

// Now sign this message with the user's wallet
```

**Parameters:**

| Name | Type | Required | Description |
|------|------|----------|-------------|
| `timestamp` | `number` | No | Unix timestamp in milliseconds. Defaults to `Date.now()` |

**Returns:** `string` - The message to be signed

---

### buildDeepLink

Build a deep link URL for the Proof KYC verification flow.

Partners can use this to redirect users to complete KYC verification. After verification, users are redirected to the specified `redirectUri`.

```typescript
const link = dflow.proof.buildDeepLink({
  wallet: '7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU',
  signature: 'base58_signature_here',
  timestamp: 1699123456789,
  redirectUri: 'https://myapp.com/verification-complete',
  projectId: 'my-dapp',
});

console.log(link);
// https://dflow.net/proof?wallet=7xKXtg...&signature=...&timestamp=...&redirect_uri=...
```

**Parameters:**

| Name | Type | Required | Description |
|------|------|----------|-------------|
| `params.wallet` | `string` | Yes | Solana wallet address to verify |
| `params.signature` | `string` | Yes | Base58 encoded signature proving wallet ownership |
| `params.timestamp` | `number` | Yes | Unix timestamp in milliseconds when the signature was created |
| `params.redirectUri` | `string` | Yes | URL to redirect to after verification completes |
| `params.projectId` | `string` | No | Optional partner project identifier |

**Returns:** `string` - Complete deep link URL

---

## Types

### VerifyAddressResponse

```typescript
interface VerifyAddressResponse {
  /** Whether the address has been verified */
  verified: boolean;
}
```

### DeepLinkParams

```typescript
interface DeepLinkParams {
  /** Solana wallet address to verify */
  wallet: string;
  /** Base58 encoded signature proving wallet ownership */
  signature: string;
  /** Unix timestamp in milliseconds when the signature was created */
  timestamp: number;
  /** URL to redirect to after verification completes */
  redirectUri: string;
  /** Optional partner project identifier */
  projectId?: string;
}
```

---

## Examples

### Complete Integration Flow

Here's a complete example of integrating Proof KYC verification:

```typescript
import { DFlowClient } from 'dflow-sdk';

const dflow = new DFlowClient();

async function handleKycVerification(walletAddress: string) {
  // Step 1: Check if user is already verified
  const result = await dflow.proof.verifyAddress(walletAddress);

  if (result.verified) {
    console.log('User is already verified! Proceed with trading.');
    return true;
  }

  console.log('User needs to complete KYC verification.');

  // Step 2: Generate signature message
  const timestamp = Date.now();
  const message = dflow.proof.generateSignatureMessage(timestamp);
  console.log(`Ask user to sign: ${message}`);

  // Step 3: After user signs, build deep link
  // In a real app, get the signature from the wallet
  const userSignature = await requestWalletSignature(message); // Your wallet integration

  const deepLink = dflow.proof.buildDeepLink({
    wallet: walletAddress,
    signature: userSignature,
    timestamp,
    redirectUri: 'https://myapp.com/kyc-complete',
    projectId: 'my-trading-app',
  });

  console.log(`Redirect user to: ${deepLink}`);
  // window.location.href = deepLink; // Redirect in browser

  return false;
}
```

### With Solana Wallet Adapter

```typescript
import { useWallet } from '@solana/wallet-adapter-react';
import { DFlowClient } from 'dflow-sdk';
import bs58 from 'bs58';

function KycButton() {
  const { publicKey, signMessage } = useWallet();
  const dflow = new DFlowClient();

  async function handleKyc() {
    if (!publicKey || !signMessage) return;

    // Check verification status
    const status = await dflow.proof.verifyAddress(publicKey.toBase58());
    if (status.verified) {
      alert('Already verified!');
      return;
    }

    // Generate and sign message
    const timestamp = Date.now();
    const message = dflow.proof.generateSignatureMessage(timestamp);
    const messageBytes = new TextEncoder().encode(message);
    const signatureBytes = await signMessage(messageBytes);
    const signature = bs58.encode(signatureBytes);

    // Build deep link and redirect
    const link = dflow.proof.buildDeepLink({
      wallet: publicKey.toBase58(),
      signature,
      timestamp,
      redirectUri: window.location.origin + '/kyc-complete',
    });

    window.location.href = link;
  }

  return <button onClick={handleKyc}>Complete KYC</button>;
}
```

### Polling for Verification Status

```typescript
async function waitForVerification(
  walletAddress: string,
  maxAttempts = 60,
  intervalMs = 5000
): Promise<boolean> {
  for (let i = 0; i < maxAttempts; i++) {
    const result = await dflow.proof.verifyAddress(walletAddress);
    if (result.verified) {
      return true;
    }
    await new Promise(resolve => setTimeout(resolve, intervalMs));
  }
  return false;
}

// Usage: After redirecting user to deep link
const verified = await waitForVerification(walletAddress);
if (verified) {
  console.log('KYC complete! User can now trade.');
}
```

---

## Constants

The SDK exports Proof-related constants:

```typescript
import {
  PROOF_API_BASE_URL,            // 'https://proof.dflow.net'
  PROOF_DEEP_LINK_BASE_URL,      // 'https://dflow.net/proof'
  PROOF_SIGNATURE_MESSAGE_PREFIX // 'Proof KYC verification: '
} from 'dflow-sdk';
```

| Constant | Value | Description |
|----------|-------|-------------|
| `PROOF_API_BASE_URL` | `https://proof.dflow.net` | Base URL for the Proof verification API |
| `PROOF_DEEP_LINK_BASE_URL` | `https://dflow.net/proof` | Base URL for KYC deep links |
| `PROOF_SIGNATURE_MESSAGE_PREFIX` | `Proof KYC verification: ` | Prefix for signature messages |
